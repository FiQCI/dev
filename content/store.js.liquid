---
permalink: store.js
---

{%- capture blogs -%}
[
  {% for post in site.publications %}
    {
      "key": "{{ post.url | slugify }}",
      "title": "{{ post.title | xml_escape }}",
      "content": {{ post.content | strip_html | strip_newlines | jsonify }},
      "url": "{{ post.url | xml_escape }}",
      "tags": [{% for tag in post.tags %}"{{ tag }}"{% unless forloop.last %}, {% endunless %}{% endfor %}],
      "type": "post",
      "date": "{{ post.date | date: '%-d.%-m.%Y' }}"
    }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
{%- endcapture -%}

{%- capture events -%}
[
  {% for event in site.events %}
    {
      "key": "{{ event.url | slugify }}",
      "title": "{{ event.title | xml_escape }}",
      "content": {{ event.content | strip_html | strip_newlines | jsonify }},
      "url": "{{ event.url | xml_escape }}",
      "tags": [{% for tag in event.tags %}"{{ tag }}"{% unless forloop.last %}, {% endunless %}{% endfor %}],
      "type": "Event",
      "date": "{{ event.date | date: '%-d.%-m.%Y' }}",
      "link": "{{ event.link | xml_escape }}"
    }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
{%- endcapture -%}

{%- capture pages -%}
[
  {%- assign filtered_pages = site.pages | where_exp: "page", "page.url contains '/'" -%}
  {%- assign filtered_pages = filtered_pages | reject: "url", "/404.html" -%}
  {%- assign filtered_pages = filtered_pages | reject: "url", "/api/" -%}
  {%- for page in filtered_pages -%}
    {%- unless page.url contains '.json' or page.url contains '.css' or page.url contains '.js' or page.path contains '/api/' -%}
    {%- assign base_content = page.content | default: "" -%}
    {%- if page.url == "/" -%}
      {%- assign full_content = base_content | append: site.data.constants.hero | append: site.data.contants.access_cards -%}
    {%- else -%}
      {%- assign full_content = base_content -%}
    {%- endif -%}
    {
      "key": "{{ page.url | slugify }}",
      "title": {{ page.title | default: "" | jsonify }},
      "content": {{ full_content | strip_html | strip_newlines | jsonify }},
      "url": {{ page.url | jsonify }},
      "tags": [],
      "type": "page"
    }{% unless forloop.last %},{% endunless %}
    {%- endunless -%}
  {%- endfor -%}
]
{%- endcapture -%}



const STORE = {
  blogs: {{blogs}},
  events: {{events}},
  pages: {{pages}}
};
